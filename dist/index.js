!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Ezelte={})}(this,(function(t){"use strict";function e(){}function s(t){return t()}function n(){return Object.create(null)}function i(t){t.forEach(s)}function o(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t){return 0===Object.keys(t).length}function l(t,e){t.appendChild(e)}function u(t,e,s){t.insertBefore(e,s||null)}function a(t){t.parentNode.removeChild(t)}function d(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function f(){return h(" ")}function $(t,e,s,n){return t.addEventListener(e,s,n),()=>t.removeEventListener(e,s,n)}function p(t,e,s){null==s?t.removeAttribute(e):t.getAttribute(e)!==s&&t.setAttribute(e,s)}function m(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function g(t,e){t.value=null==e?"":e}function b(t,e,s,n){t.style.setProperty(e,s,n?"important":"")}function y(t,e,s){t.classList[s?"add":"remove"](e)}class k{constructor(t=null){this.a=t,this.e=this.n=null}m(t,e,s=null){this.e||(this.e=d(e.nodeName),this.t=e,this.h(t)),this.i(s)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)u(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(a)}}function x(t){const e={};for(const s of t)e[s.name]=s.value;return e}let _;function v(t){_=t}function w(t){(function(){if(!_)throw new Error("Function called outside component initialization");return _})().$$.on_mount.push(t)}const z=[],E=[],C=[],L=[],T=Promise.resolve();let O=!1;function j(t){C.push(t)}let A=!1;const M=new Set;function N(){if(!A){A=!0;do{for(let t=0;t<z.length;t+=1){const e=z[t];v(e),S(e.$$)}for(v(null),z.length=0;E.length;)E.pop()();for(let t=0;t<C.length;t+=1){const e=C[t];M.has(e)||(M.add(e),e())}C.length=0}while(z.length);for(;L.length;)L.pop()();O=!1,A=!1,M.clear()}}function S(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(j)}}const H=new Set;let U;function P(t,e){t&&t.i&&(H.delete(t),t.i(e))}function R(t,e,s,n){if(t&&t.o){if(H.has(t))return;H.add(t),undefined.c.push((()=>{H.delete(t),n&&(s&&t.d(1),n())})),t.o(e)}}function J(t){t&&t.c()}function D(t,e,n,r){const{fragment:c,on_mount:l,on_destroy:u,after_update:a}=t.$$;c&&c.m(e,n),r||j((()=>{const e=l.map(s).filter(o);u?u.push(...e):i(e),t.$$.on_mount=[]})),a.forEach(j)}function I(t,e){const s=t.$$;null!==s.fragment&&(i(s.on_destroy),s.fragment&&s.fragment.d(e),s.on_destroy=s.fragment=null,s.ctx=[])}function q(t,e){-1===t.$$.dirty[0]&&(z.push(t),O||(O=!0,T.then(N)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function B(t,s,o,r,c,l,u=[-1]){const d=_;v(t);const h=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:s.context||[]),callbacks:n(),dirty:u,skip_bound:!1};let f=!1;if(h.ctx=o?o(t,s.props||{},((e,s,...n)=>{const i=n.length?n[0]:s;return h.ctx&&c(h.ctx[e],h.ctx[e]=i)&&(!h.skip_bound&&h.bound[e]&&h.bound[e](i),f&&q(t,e)),s})):[],h.update(),f=!0,i(h.before_update),h.fragment=!!r&&r(h.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);h.fragment&&h.fragment.l(t),t.forEach(a)}else h.fragment&&h.fragment.c();s.intro&&P(t.$$.fragment),D(t,s.target,s.anchor,s.customElement),N()}v(d)}"function"==typeof HTMLElement&&(U=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(s).filter(o);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,s){this[t]=s}disconnectedCallback(){i(this.$$.on_disconnect)}$destroy(){I(this,1),this.$destroy=e}$on(t,e){const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{const t=s.indexOf(e);-1!==t&&s.splice(t,1)}}$set(t){this.$$set&&!c(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});const F="undefined"!=typeof window&&void 0!==window.document;let G={};["get","post","delete","put"].forEach((t=>{G[t]=async(e,s,n)=>await(async(t,e,s,n)=>{Array.isArray(e)&&(e=e.join("/"));try{let i={};if("delete"==t&&(i={...i,credentials:"include",method:t.toUpperCase()}),"get"==t&&s){const n=Object.keys(s);for(let t=0;t<n.length;t++){const i=n[t];0==t&&(e+="?"),null!=s[i]&&""!=s[i]&&(e+=`${i}=${encodeURIComponent(s[i])}`,t!=n.length-1&&(e+="&"))}i={...i,credentials:"include",method:t.toUpperCase()}}if("put"!=t&&"post"!=t||(i={...i,credentials:"include",method:t.toUpperCase(),body:JSON.stringify(s||{}),headers:{"Content-Type":"application/json"}}),n||console.log(`[fetcher] 🌟  ${e}`,i),!F)return{ok:!1,error:!0,message:"server side"};const o=await fetch(e,i);let r=await o.text();try{r=JSON.parse(r)}catch(t){}return o.ok&&!r?.error||console.log(`[fetcher] ❌  ${e}`,r.message,r.status,r.code),!o.ok||r?.error?r:(n||console.log(`[fetcher] ✅  ${e}`),(t=>({code:200,status:200,error:!1,ok:!0,data:t}))(r))}catch(t){return n||console.log(`[fetcher] ❌  ${e}`,t.message,t.status,t.code),{code:i=500,status:i,error:!0,ok:!1,message:t.message}}var i})(t,e,s,n)}));const K=(t,e,s)=>`${t}/api/${e}/${s}`;function Q(t,e,s){const n=t.slice();return n[29]=e[s],n[30]=e,n[31]=s,n}function V(t){let e,s,n,o,r,c,x,_,v,w,z,E,C,L,T,O,j,A,M,N,S=t[4]?"update":"subscribe",H=(t[6]||"")+"",U=(t[8]||"")+"",P=t[12],R=[];for(let e=0;e<P.length;e+=1)R[e]=X(Q(t,P,e));let J=t[4]&&Y(t);return{c(){e=d("form"),n=f(),o=d("input"),r=f(),c=d("input"),_=f();for(let t=0;t<R.length;t+=1)R[t].c();v=f(),w=d("button"),z=h(S),E=f(),J&&J.c(),C=f(),L=d("div"),T=h(H),O=f(),s=new k(n),o.disabled=t[7],p(o,"id","name"),p(o,"placeholder","name"),p(o,"name","name"),p(o,"type","text"),p(o,"class","ezipe-field-name"),y(o,"none",t[8]||t[4]),c.disabled=x=t[7]||t[4],p(c,"id","address"),p(c,"placeholder","email"),p(c,"name","address"),p(c,"type","text"),p(c,"class","ezipe-field-address"),y(c,"none",t[8]),p(w,"class","ezipe-button ezipe-button-submit filled"),w.disabled=t[7],y(w,"none",t[8]),b(L,"margin-bottom","0",1),p(L,"class","ezipe-error error"),y(L,"hidden",!t[6]),y(L,"none",t[8]),j=new k(null),p(e,"action",t[10]),p(e,"class",A="ezipe-mailing-list "+t[2]),p(e,"style",t[3])},m(i,a){u(i,e,a),s.m(t[11],e),l(e,n),l(e,o),g(o,t[0]),l(e,r),l(e,c),g(c,t[1]),l(e,_);for(let t=0;t<R.length;t+=1)R[t].m(e,null);l(e,v),l(e,w),l(w,z),l(e,E),J&&J.m(e,null),l(e,C),l(e,L),l(L,T),l(e,O),j.m(U,e),M||(N=[$(o,"input",t[23]),$(c,"input",t[24]),$(e,"submit",t[13])],M=!0)},p(t,n){if(2048&n[0]&&s.p(t[11]),128&n[0]&&(o.disabled=t[7]),1&n[0]&&o.value!==t[0]&&g(o,t[0]),272&n[0]&&y(o,"none",t[8]||t[4]),144&n[0]&&x!==(x=t[7]||t[4])&&(c.disabled=x),2&n[0]&&c.value!==t[1]&&g(c,t[1]),256&n[0]&&y(c,"none",t[8]),4512&n[0]){let s;for(P=t[12],s=0;s<P.length;s+=1){const i=Q(t,P,s);R[s]?R[s].p(i,n):(R[s]=X(i),R[s].c(),R[s].m(e,v))}for(;s<R.length;s+=1)R[s].d(1);R.length=P.length}16&n[0]&&S!==(S=t[4]?"update":"subscribe")&&m(z,S),128&n[0]&&(w.disabled=t[7]),256&n[0]&&y(w,"none",t[8]),t[4]?J?J.p(t,n):(J=Y(t),J.c(),J.m(e,C)):J&&(J.d(1),J=null),64&n[0]&&H!==(H=(t[6]||"")+"")&&m(T,H),64&n[0]&&y(L,"hidden",!t[6]),256&n[0]&&y(L,"none",t[8]),256&n[0]&&U!==(U=(t[8]||"")+"")&&j.p(U),1024&n[0]&&p(e,"action",t[10]),4&n[0]&&A!==(A="ezipe-mailing-list "+t[2])&&p(e,"class",A),8&n[0]&&p(e,"style",t[3])},d(t){t&&a(e),function(t,e){for(let s=0;s<t.length;s+=1)t[s]&&t[s].d(e)}(R,t),J&&J.d(),M=!1,i(N)}}}function W(t){let e;return{c(){e=d("div"),p(e,"class","ezipe-error ezipe-invalid")},m(s,n){u(s,e,n),e.innerHTML=t[9]},p(t,s){512&s[0]&&(e.innerHTML=t[9])},d(t){t&&a(e)}}}function X(t){let e,s,n,i,o,r,c,h,m,g,x,_=t[29].key+"",v=t[29].text+"";function w(){t[25].call(s,t[29])}return{c(){e=d("label"),s=d("input"),n=f(),i=d("span"),o=f(),c=f(),h=d("em"),s.disabled=t[7],p(s,"type","checkbox"),r=new k(c),p(h,"class","fade ml0-6"),b(e,"user-select","none"),p(e,"class",m="ezipe-field-label ezipe-field-"+t[29].key+" checkbox pointer user-select-none"),y(e,"none",t[8]),y(e,"disabled",t[7])},m(a,d){u(a,e,d),l(e,s),s.checked=t[5][t[29].key],l(e,n),l(e,i),l(e,o),r.m(_,e),l(e,c),l(e,h),h.innerHTML=v,g||(x=$(s,"change",w),g=!0)},p(n,i){t=n,128&i[0]&&(s.disabled=t[7]),4128&i[0]&&(s.checked=t[5][t[29].key]),4096&i[0]&&_!==(_=t[29].key+"")&&r.p(_),4096&i[0]&&v!==(v=t[29].text+"")&&(h.innerHTML=v),4096&i[0]&&m!==(m="ezipe-field-label ezipe-field-"+t[29].key+" checkbox pointer user-select-none")&&p(e,"class",m),4352&i[0]&&y(e,"none",t[8]),4224&i[0]&&y(e,"disabled",t[7])},d(t){t&&a(e),g=!1,x()}}}function Y(t){let s,n,i;return{c(){s=d("button"),s.textContent="unsubscribe",p(s,"class","ezipe-button ezipe-button-unsubscribe")},m(e,o){u(e,s,o),n||(i=$(s,"click",t[14]),n=!0)},p:e,d(t){t&&a(s),n=!1,i()}}}function Z(t){let s;function n(t,e){return t[9]?W:V}let i=n(t),o=i(t);return{c(){o.c(),s=h("")},m(t,e){o.m(t,e),u(t,s,e)},p(t,e){i===(i=n(t))&&o?o.p(t,e):(o.d(1),o=i(t),o&&(o.c(),o.m(s.parentNode,s)))},i:e,o:e,d(t){o.d(t),t&&a(s)}}}function tt(t){return t.slice(t.indexOf("?")+1).split("&").reduce(((t,e)=>{let[s,n]=e.split("="),i=!!n&&decodeURIComponent(n);return Object.assign(t,{[s]:i})}),{})}function et(t){return"string"!=typeof t?t:t.split(",").filter((t=>""!=t)).map((t=>({key:t.split(":")[0],text:t.split(":")[1]})))}function st(t,e,s){let n,i,o,r;const c="undefined"!=typeof window&&void 0!==window.document;let l,u,a,d,{interests:h=[]}=e,{name:f=""}=e,{address:$=""}=e,{root:p=null}=e,{user:m=null}=e,{css:g=""}=e,{message:b="Success"}=e,{link:y="/"}=e,{button:k="return"}=e,{class_:x=""}=e,{style_:_=""}=e,{init:v=""}=e,z={},{editor:E=!1}=e;return w((async t=>{console.log(`[list-signup] ✨  mounted with ${p} ${m} ${JSON.stringify(z)}`)})),t.$$set=t=>{"interests"in t&&s(15,h=t.interests),"name"in t&&s(0,f=t.name),"address"in t&&s(1,$=t.address),"root"in t&&s(16,p=t.root),"user"in t&&s(17,m=t.user),"css"in t&&s(18,g=t.css),"message"in t&&s(19,b=t.message),"link"in t&&s(20,y=t.link),"button"in t&&s(21,k=t.button),"class_"in t&&s(2,x=t.class_),"style_"in t&&s(3,_=t.style_),"init"in t&&s(22,v=t.init),"editor"in t&&s(4,E=t.editor)},t.$$.update=()=>{32784&t.$$.dirty[0]&&function(t,e){let n=c?window.location.search:"";n=""!=n&&c?tt(n):v;const i=tt(n);s(1,$=i.address),""==$&&s(1,$=null);const o=et(e||"");(i.vars||"").split(",").forEach((t=>{o.find((e=>e.key==t))&&s(5,z[t]=!0,z)})),E&&($&&0!=Object.keys(z).length||s(9,d=`\n                <div class="ezipe-success ezipe-message">Address and vars must be set in URL search params, ie:</div>\n                <div class="ezipe-success ezipe-details monospace mt2">?address=${$||"foo@bar.com"}&news=annoucements&code=opensource</div>\n            `))}(0,h),3670019&t.$$.dirty[0]&&(n=`\n        <div>${b}</div>\n        <div class="monospace mb2">${f} &lt;${$}&gt;</div>\n        <a class="filled button text-center" href="${y}">${k}</a>\n    `),196608&t.$$.dirty[0]&&s(10,i=K(p,m,"signup_mailing_list")),262144&t.$$.dirty[0]&&s(11,o=`\n        <style>\n            @import "${g}";\n        </style>\n    `),32768&t.$$.dirty[0]&&s(12,r="string"==typeof h?et(h):h)},[f,$,x,_,E,z,l,u,a,d,i,o,r,async function(t){console.log("[list-signup] 🌐  submitting",{name:f,address:$,vars:z}),s(6,l=null),s(7,u=!0),t.preventDefault(),t.stopPropagation();const e=await G.post(t.target.action,{name:f,address:$,vars:z});console.log(e),e.ok&&s(8,a=n),e.ok||s(6,l=e.message),s(7,u=!1)},async function(t){s(6,l=null),s(7,u=!0),t.preventDefault(),t.stopPropagation();const e=await G.post(K(p,m,"unsubscribe_mailing_list"),{name:f,address:$,vars:z});e.ok&&s(8,a=n),e.ok||s(6,l=e.message),s(7,u=!1)},h,p,m,g,b,y,k,v,function(){f=this.value,s(0,f)},function(){$=this.value,s(1,$)},function(t){z[t.key]=this.checked,s(5,z),s(12,r),s(15,h)}]}class nt extends class{$destroy(){I(this,1),this.$destroy=e}$on(t,e){const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{const t=s.indexOf(e);-1!==t&&s.splice(t,1)}}$set(t){this.$$set&&!c(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),B(this,t,st,Z,r,{interests:15,name:0,address:1,root:16,user:17,css:18,message:19,link:20,button:21,class_:2,style_:3,init:22,editor:4},[-1,-1])}}function it(t){let s,n;return s=new nt({props:{interests:t[0],root:t[1],user:t[2],css:t[3],message:t[4],link:t[5],button:t[6],style_:t[9],class_:t[8],init:t[7],editor:!1}}),{c(){J(s.$$.fragment),this.c=e},m(t,e){D(s,t,e),n=!0},p(t,[e]){const n={};1&e&&(n.interests=t[0]),2&e&&(n.root=t[1]),4&e&&(n.user=t[2]),8&e&&(n.css=t[3]),16&e&&(n.message=t[4]),32&e&&(n.link=t[5]),64&e&&(n.button=t[6]),512&e&&(n.style_=t[9]),256&e&&(n.class_=t[8]),128&e&&(n.init=t[7]),s.$set(n)},i(t){n||(P(s.$$.fragment,t),n=!0)},o(t){R(s.$$.fragment,t),n=!1},d(t){I(s,t)}}}function ot(t,e,s){let{interests:n=[]}=e,{root:i=null}=e,{user:o=null}=e,{css:r=""}=e,{message:c="Thank you, you have been subscribed as:"}=e,{link:l="/"}=e,{button:u="return"}=e,{init:a=""}=e,{class:d=""}=e,{style:h=""}=e;return t.$$set=t=>{"interests"in t&&s(0,n=t.interests),"root"in t&&s(1,i=t.root),"user"in t&&s(2,o=t.user),"css"in t&&s(3,r=t.css),"message"in t&&s(4,c=t.message),"link"in t&&s(5,l=t.link),"button"in t&&s(6,u=t.button),"init"in t&&s(7,a=t.init),"class"in t&&s(8,d=t.class),"style"in t&&s(9,h=t.style)},[n,i,o,r,c,l,u,a,d,h]}class rt extends U{constructor(t){super(),B(this,{target:this.shadowRoot,props:x(this.attributes),customElement:!0},ot,it,r,{interests:0,root:1,user:2,css:3,message:4,link:5,button:6,init:7,class:8,style:9}),t&&(t.target&&u(t.target,this,t.anchor),t.props&&(this.$set(t.props),N()))}static get observedAttributes(){return["interests","root","user","css","message","link","button","init","class","style"]}get interests(){return this.$$.ctx[0]}set interests(t){this.$set({interests:t}),N()}get root(){return this.$$.ctx[1]}set root(t){this.$set({root:t}),N()}get user(){return this.$$.ctx[2]}set user(t){this.$set({user:t}),N()}get css(){return this.$$.ctx[3]}set css(t){this.$set({css:t}),N()}get message(){return this.$$.ctx[4]}set message(t){this.$set({message:t}),N()}get link(){return this.$$.ctx[5]}set link(t){this.$set({link:t}),N()}get button(){return this.$$.ctx[6]}set button(t){this.$set({button:t}),N()}get init(){return this.$$.ctx[7]}set init(t){this.$set({init:t}),N()}get class(){return this.$$.ctx[8]}set class(t){this.$set({class:t}),N()}get style(){return this.$$.ctx[9]}set style(t){this.$set({style:t}),N()}}function ct(t){let s,n;return s=new nt({props:{interests:t[0],root:t[1],user:t[2],css:t[3],message:t[4],link:t[5],button:t[6],style_:t[9],class_:t[8],init:t[7],editor:!0}}),{c(){J(s.$$.fragment),this.c=e},m(t,e){D(s,t,e),n=!0},p(t,[e]){const n={};1&e&&(n.interests=t[0]),2&e&&(n.root=t[1]),4&e&&(n.user=t[2]),8&e&&(n.css=t[3]),16&e&&(n.message=t[4]),32&e&&(n.link=t[5]),64&e&&(n.button=t[6]),512&e&&(n.style_=t[9]),256&e&&(n.class_=t[8]),128&e&&(n.init=t[7]),s.$set(n)},i(t){n||(P(s.$$.fragment,t),n=!0)},o(t){R(s.$$.fragment,t),n=!1},d(t){I(s,t)}}}function lt(t,e,s){let{interests:n=[]}=e,{root:i=null}=e,{user:o=null}=e,{css:r=""}=e,{message:c="Mailing list settings updated:"}=e,{link:l="/"}=e,{button:u="return"}=e,{init:a=""}=e,{class:d=""}=e,{style:h=""}=e;return t.$$set=t=>{"interests"in t&&s(0,n=t.interests),"root"in t&&s(1,i=t.root),"user"in t&&s(2,o=t.user),"css"in t&&s(3,r=t.css),"message"in t&&s(4,c=t.message),"link"in t&&s(5,l=t.link),"button"in t&&s(6,u=t.button),"init"in t&&s(7,a=t.init),"class"in t&&s(8,d=t.class),"style"in t&&s(9,h=t.style)},[n,i,o,r,c,l,u,a,d,h]}customElements.define("list-signup",rt);class ut extends U{constructor(t){super(),B(this,{target:this.shadowRoot,props:x(this.attributes),customElement:!0},lt,ct,r,{interests:0,root:1,user:2,css:3,message:4,link:5,button:6,init:7,class:8,style:9}),t&&(t.target&&u(t.target,this,t.anchor),t.props&&(this.$set(t.props),N()))}static get observedAttributes(){return["interests","root","user","css","message","link","button","init","class","style"]}get interests(){return this.$$.ctx[0]}set interests(t){this.$set({interests:t}),N()}get root(){return this.$$.ctx[1]}set root(t){this.$set({root:t}),N()}get user(){return this.$$.ctx[2]}set user(t){this.$set({user:t}),N()}get css(){return this.$$.ctx[3]}set css(t){this.$set({css:t}),N()}get message(){return this.$$.ctx[4]}set message(t){this.$set({message:t}),N()}get link(){return this.$$.ctx[5]}set link(t){this.$set({link:t}),N()}get button(){return this.$$.ctx[6]}set button(t){this.$set({button:t}),N()}get init(){return this.$$.ctx[7]}set init(t){this.$set({init:t}),N()}get class(){return this.$$.ctx[8]}set class(t){this.$set({class:t}),N()}get style(){return this.$$.ctx[9]}set style(t){this.$set({style:t}),N()}}customElements.define("list-update",ut),t.ListSignup=rt,t.ListUpdate=ut,Object.defineProperty(t,"__esModule",{value:!0})}));
